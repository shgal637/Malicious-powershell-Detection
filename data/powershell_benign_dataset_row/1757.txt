Import-Module AzureRM.NetCore.PreviewLogin-AzureRmAccount$resourceGroupName = "PSAzDemo" + (New-Guid | ForEach-Object guid) -replace "-",""$resourceGroupNameNew-AzureRmResourceGroup -Name $resourceGroupName -Location "West US"$dnsLabelPrefix = $resourceGroupName | ForEach-Object tolower$dnsLabelPrefix$password = ConvertTo-SecureString -String "PowerShellRocks!" -AsPlainText -ForceNew-AzureRmResourceGroupDeployment -ResourceGroupName $resourceGroupName -TemplateFile ./Compute-Linux.json -adminUserName psuser -adminPassword $password -dnsLabelPrefix $dnsLabelPrefixGet-AzureRmResourceGroupDeployment -ResourceGroupName $resourceGroupNameFind-AzureRmResource -ResourceGroupName $resourceGroupName | Select-Object Name,ResourceType,LocationGet-AzureRmResource -ResourceName MyUbuntuVM -ResourceType Microsoft.Compute/virtualMachines -ResourceGroupName $resourceGroupName -ODataQuery '$expand=instanceView' | ForEach-Object properties | ForEach-Object instanceview | ForEach-Object statusesGet-AzureRmProviderOperation -OperationSearchString Microsoft.Compute/* | Select-Object OperationName,OperationInvoke-AzureRmResourceAction -ResourceGroupName $resourceGroupName -ResourceType Microsoft.Compute/virtualMachines -ResourceName MyUbuntuVM -Action poweroffGet-AzureRmResource -ResourceName MyUbuntuVM -ResourceType Microsoft.Compute/virtualMachines -ResourceGroupName $resourceGroupName -ODataQuery '$expand=instanceView' | ForEach-Object properties | ForEach-Object instanceview | ForEach-Object statusesInvoke-AzureRmResourceAction -ResourceGroupName $resourceGroupName -ResourceType Microsoft.Compute/virtualMachines -ResourceName MyUbuntuVM -Action deallocateRemove-AzureRmResource -ResourceName MyUbuntuVM -ResourceType Microsoft.Compute/virtualMachines -ResourceGroupName $resourceGroupNameFind-AzureRmResource -ResourceGroupName $resourceGroupName | Select-Object Name,ResourceType,LocationRemove-AzureRmResourceGroup -Name $resourceGroupName