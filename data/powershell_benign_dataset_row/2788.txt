if (Get-Command logparser.exe) {$lpquery = @"SELECTCOUNT(Protocol,State,Component,Process) as Cnt,Protocol,State,Component,ProcessFROM*netstat.csvWHEREConPid not in ('0'; '4') andState = 'LISTENING'GROUP BYProtocol,State,Component,ProcessORDER BYCnt, Process desc"@& logparser -stats:off -i:csv -dtlines:0 -rtp:-1 $lpquery} else {$ScriptName = [System.IO.Path]::GetFileName($MyInvocation.ScriptName)"${ScriptName} requires logparser.exe in the path."}