[CmdletBinding()]param([ValidateNotNullOrEmpty()][string]$File = 'C:\WinPE\SCCM.iso')Import-Module Dism$Directory = $File.substring(0, $File.LastIndexOf('\'))$Drive = ((Mount-DiskImage -ImagePath $File) | Get-Volume).DriveLetterRemove-Item -Path ($Directory + '\Mount') -Recurse -Force -ErrorAction SilentlyContinueNew-Item -Path ($Directory + '\Mount') -ItemType Directory -ForceRemove-Item -Path ($Directory + '\boot.wim') -ErrorAction SilentlyContinue -ForceCopy-Item -Path ($Drive + ':\sources\boot.wim') -Destination $Directory -ForceSet-ItemProperty -Path ($Directory + '\boot.wim') -Name IsReadOnly -Value $falseMount-WindowsImage -ImagePath ($Directory + '\boot.wim') -Index 1 -Path ($Directory + '\Mount')Copy-Item -Path ($Drive + ':\SMS\data') -Destination ($Directory + '\Mount\sms') -Recurse -ForceDismount-WindowsImage -Path ($Directory + '\Mount') -SaveDismount-DiskImage -ImagePath $FileRemove-Item -Path ((Get-ChildItem -Path ($Directory + '\' + ((Get-ChildItem -path $File -ErrorAction SilentlyContinue).Basename) + '.wim')).FullName) -Force -ErrorAction SilentlyContinueRename-Item -Path ($Directory + '\boot.wim') -NewName ((Get-ChildItem -Path $File).BaseName + '.wim') -ForceRemove-Item -Path ($Directory + '\Mount') -Recurse -Force -ErrorAction SilentlyContinue