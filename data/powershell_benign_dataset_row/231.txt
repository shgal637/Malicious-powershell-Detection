function Get-SCSMServiceRequestComment{PARAM([Parameter(ParameterSetName = 'General',Mandatory = $true)]$DateTime = $((Get-Date).AddHours(-24)),[Parameter(ParameterSetName = 'GUID')]$GUID)IF ($PSBoundParameters['GUID']){$Tickets = Get-SCSMObject -id $GUID}ELSE{if ($DateTime -is [String]){ $DateTime = Get-Date $DateTime}$DateTime = $DateTime.ToString(“yyy-MM-dd HH:mm:ss”)$Tickets = Get-SCSMObject -Class (Get-SCSMClass System.WorkItem.servicerequest$) -Filter "CreatedDate -gt '$DateTime'" }$Tickets |ForEach-Object {$CurrentTicket = $_$relatedObjects = Get-scsmrelatedobject -SMObject $CurrentTicketForeach ($Comment in ($relatedObjects | Where-Object { $_.classname -eq 'System.WorkItem.TroubleTicket.UserCommentLog' -or $_.classname -eq 'System.WorkItem.TroubleTicket.AnalystCommentLog' -or $_.classname -eq 'System.WorkItem.TroubleTicket.AuditCommentLog'})){[pscustomobject][ordered] @{TicketName = $CurrentTicket.NameTicketClassName = $CurrentTicket.ClassnameTicketDisplayName = $CurrentTicket.DisplayNameTicketID = $CurrentTicket.IDTicketGUID = $CurrentTicket.get_id()TicketSupportGroup = $CurrentTicket.SupportGroup.displaynameTicketAssignedTo = $CurrentTicket.AssignedToTicketCreatedDate = $CurrentTicket.CreatedDateComment = $Comment.CommentCommentEnteredBy = $Comment.EnteredByCommentEnteredDate = $Comment.EnteredDateCommentClassName = $Comment.ClassName}}}}