if (Get-Command logparser.exe) {$lpquery = @"SELECTCOUNT(ServiceName, CmdLine,FailAction1,FailAction2,FailAction3) as ct, ServiceName, CmdLine,FailAction1,FailAction2,FailAction3FROM*SvcFail.tsvWHERECmdLine <> 'customScript.cmd' ANDCmdLine is not NULLGROUP BYServiceName, CmdLine,FailAction1,FailAction2,FailAction3ORDER BYct ASC"@& logparser -stats:off -i:csv -fixedsep:on -dtlines:0 -rtp:-1 $lpquery} else {$ScriptName = [System.IO.Path]::GetFileName($MyInvocation.ScriptName)"${ScriptName} requires logparser.exe in the path."}