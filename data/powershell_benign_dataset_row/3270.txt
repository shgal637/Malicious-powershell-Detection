class Message {[string]$Id                 [MessageType]$Type = [MessageType]::Message[MessageSubtype]$Subtype = [MessageSubtype]::None    [string]$Text               [string]$To                 [string]$ToName             [string]$From               [string]$FromName           [datetime]$Time             [bool]$IsDM                 [hashtable]$Options         [pscustomobject]$RawMessage [Message]Clone () {$newMsg = [Message]::New()foreach ($prop in ($this | Get-Member -MemberType Property)) {if ('Clone' -in ($this.$($prop.Name) | Get-Member -MemberType Method -ErrorAction Ignore).Name) {$newMsg.$($prop.Name) = $this.$($prop.Name).Clone()} else {$newMsg.$($prop.Name) = $this.$($prop.Name)}}return $newMsg}[hashtable] ToHash() {return @{Id         = $this.IdType       = $this.Type.ToString()Subtype    = $this.Subtype.ToString()Text       = $this.TextTo         = $this.ToToName     = $this.ToNameFrom       = $this.FromFromName   = $this.FromNameTime       = $this.Time.ToUniversalTime().ToString('u')IsDM       = $this.IsDMOptions    = $this.OptionsRawMessage = $this.RawMessage}}[string] ToJson() {return $this.ToHash() | ConvertTo-Json -Depth 10 -Compress}}