function New-ModuleSourceFromPackageSource{param([Parameter(Mandatory=$true)]$PackageSource)$moduleSource = Microsoft.PowerShell.Utility\New-Object PSCustomObject -Property ([ordered]@{Name = $PackageSource.NameSourceLocation =  $PackageSource.LocationTrusted=$PackageSource.IsTrustedRegistered=$PackageSource.IsRegisteredInstallationPolicy = $PackageSource.Details['InstallationPolicy']PackageManagementProvider=$PackageSource.Details['PackageManagementProvider']PublishLocation=$PackageSource.Details[$script:PublishLocation]ScriptSourceLocation=$PackageSource.Details[$script:ScriptSourceLocation]ScriptPublishLocation=$PackageSource.Details[$script:ScriptPublishLocation]ProviderOptions = @{}})$PackageSource.Details.GetEnumerator() | Microsoft.PowerShell.Core\ForEach-Object {if($_.Key -ne 'PackageManagementProvider' -and$_.Key -ne $script:PublishLocation -and$_.Key -ne $script:ScriptPublishLocation -and$_.Key -ne $script:ScriptSourceLocation -and$_.Key -ne 'InstallationPolicy'){$moduleSource.ProviderOptions[$_.Key] = $_.Value}}$moduleSource.PSTypeNames.Insert(0, "Microsoft.PowerShell.Commands.PSRepository")Write-Output -InputObject $moduleSource}