function Test-MrURL {[CmdletBinding()]param ([string]$Uri,[switch]$Detailed)$CurrentErrorAction = $ErrorActionPreference$ErrorActionPreference = 'SilentlyContinue'$Result = Invoke-WebRequest -Uri $Uri -TimeoutSec 30$ErrorActionPreference = $CurrentErrorActionif ($Result.StatusCode -ne 200) {$false    }elseif (-not $Detailed) {$true}else {[pscustomobject]@{StatusDescription = $Result.StatusDescriptionStatusCode = $Result.StatusCodeResponseUri = $Result.BaseResponse.ResponseUriServer = $Result.BaseResponse.Server}}}