Set-Variable -Name Command -Scope Global -ForceSet-Variable -Name Computer -Scope Global -ForceSet-Variable -Name Computers -Scope Global -ForceSet-Variable -Name i -Scope Global -Value 1 -ForceSet-Variable -Name Output -Scope Global -ForceSet-Variable -Name RelativePath -Scope Global -ForceSet-Variable -Name Results -Scope Global -ForceSet-Variable -Name Username -Scope Global -ForceFunction RenameWindow ($Title) {Set-Variable -Name a -Scope Local -Force$a = (Get-Host).UI.RawUI$a.WindowTitle = $TitleRemove-Variable -Name a -Scope Local -Force}Function GetRelativePath{$Global:RelativePath=(split-path $SCRIPT:MyInvocation.MyCommand.Path -parent)+"\"}clsRenameWindow "Who's Logged On and Logged Off?"GetRelativePath$Results = @()$Username = @()$Computers = Get-Content -Path $Global:RelativePath"Computers.txt"$Size = $Computers.LengthForeach ($Computer in $Computers) {Write-Host "Scanning System "$i" of "$SizeWrite-HostWrite-Host "System:"$Computer$Command = $Global:RelativePath+"PsLoggedon.exe -x -l \\$Computer"$Output = Invoke-Expression $CommandIf ($Output.SyncRoot[2] -eq "Users logged on locally:") {$Username += $Output.SyncRoot[3].Trim()} else {$Username += "N/A"}$Output = $Output.SyncRoot[2]$Output = $Output.Substring(0,$Output.Length-1)$Results += $Output$i = $i + 1cls}clsfor ($i=0 ; $i -lt $Results.length ; $i++) {If ($Results[$i] -eq "No one is logged on locally") {Write-Host $Computers[$i]": "$Results[$i] -BackgroundColor Yellow -ForegroundColor Black} elseIf ($Results[$i] -eq "Users logged on locally") {Write-Host $Computers[$i]": "$Results[$i]" -- "$Username[$i]-ForegroundColor White} else {Write-Host $Computers[$i]": "$Results[$i]" -- "$Username[$i]-ForegroundColor Red}}Remove-Variable -Name Command -Scope Global -ForceRemove-Variable -Name Computer -Scope Global -ForceRemove-Variable -Name Computers -Scope Global -ForceRemove-Variable -Name i -Scope Global -ForceRemove-Variable -Name Output -Scope Global -ForceRemove-Variable -Name RelativePath -Scope Global -ForceRemove-Variable -Name Results -Scope Global -ForceRemove-Variable -Name Username -Scope Global -Force