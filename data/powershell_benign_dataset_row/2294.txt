$vCenterServer = "server.contoso.com"try {if(-not (Get-PSSnapin VMware.VimAutomation.Core -ErrorAction SilentlyContinue)) {Add-PSSnapin VMware.VimAutomation.Core -ErrorAction Stop}Set-PowerCLIConfiguration -DefaultVIServerMode Single -InvalidCertificateAction Ignore -Confirm:$false -ErrorAction StopConnect-VIServer -Server $vCenterServer -ErrorAction Stop$VirtualMachine = Get-VM -Name "Win7Ref" -ErrorAction StopGet-HardDisk -VM $VirtualMachine -ErrorAction Stop | Remove-HardDisk -Confirm:$false -ErrorAction Stop$VirtualMachine | New-HardDisk -CapacityGB "60" -Confirm:$false -ErrorAction StopDisconnect-VIServer -Server $vCenterServer -Confirm:$false -ErrorAction Stop$Success = "True"}catch [System.Exception] {$Success = "False"}