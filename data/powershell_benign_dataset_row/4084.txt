Clear-Host$Global:MountPath$Global:RelativePath$Global:WimFile$Global:UpdatesPathFunction GetRelativePath{$Global:RelativePath=(split-path $SCRIPT:MyInvocation.MyCommand.Path -parent)+"\"Write-Host $Global:RelativePath}Function GetWimFile{$FileName = Get-ChildItem $Global:RelativePath | Where-Object {($_.Name -like "*.wim")}$Global:WimFile = $Global:RelativePath+$FileNameWrite-Host $Global:WimFile}Function MountWIM{$Global:MountPath = $Global:RelativePath+"Mount\"If ((Test-Path $Global:MountPath) -ne $true){New-Item -ItemType directory -Path $Global:RelativePath"Mount"}Write-Host $Global:MountPath$Arguments = "dism.exe /mount-wim /wimfile:"+$Global:WimFile+[char]32+"/index:1 /mountdir:"+$Global:MountPathWrite-Host $ArgumentsInvoke-Expression -Command $Arguments}Function UnmountWIM{$Arguments = "dism.exe /unmount-wim /mountdir:"+$Global:MountPath+[char]32+"/commit"Write-Host $ArgumentsInvoke-Expression -Command $Arguments}Function CleanupWIM{$Arguments = "dism.exe /cleanup-wim"Write-Host $ArgumentsInvoke-Expression -Command $Arguments}Function GlobalMemoryCleanup{Clear-Variable -Name MountPath -Scope Global -ForceClear-Variable -Name WimFile -Scope Global -ForceClear-Variable -Name UpdatesPath -Scope Global -ForceClear-Variable -Name RelativePath -Scope Global -ForceRemove-Variable -Name MountPath -Scope Global -ForceRemove-Variable -Name WimFile -Scope Global -ForceRemove-Variable -Name UpdatesPath -Scope Global -ForceRemove-Variable -Name RelativePath -Scope Global -Force}GetRelativePathGetWimFileMountWIM$Global:UpdatesPath = $Global:RelativePath+"*.msu"$UpdatesArray = Get-Item $Global:UpdatesPathForEach ($Updates in $UpdatesArray) {$Arguments = "dism.exe /image:"+$Global:MountPath+[char]32+"/Add-Package /PackagePath:"+$UpdatesWrite-Host $ArgumentsInvoke-Expression -Command $ArgumentsStart-Sleep -Seconds 10}UnmountWIMCleanupWIMClear-Variable -Name Arguments -Scope Local -ForceClear-Variable -Name Updates -Scope Local -ForceClear-Variable -Name UpdatesArray -Scope Local -ForceRemove-Variable -Name Arguments -Scope Local -ForceRemove-Variable -Name Updates -Scope Local -ForceRemove-Variable -Name UpdatesArray -Scope Local -ForceGlobalMemoryCleanup