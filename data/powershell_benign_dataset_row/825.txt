$cred = Get-CredentialNew-AzVmss `-ResourceGroupName "myResourceGroup" `-VMScaleSetName "myScaleSet" `-Location "EastUS2" `-VirtualNetworkName "myVnet" `-SubnetName "mySubnet" `-PublicIpAddressName "myPublicIPAddress" `-LoadBalancerName "myLoadBalancer" `-UpgradePolicyMode "Automatic" `-Credential $cred `-Zone "1"$publicSettings = @{"fileUris" = (,"https://raw.githubusercontent.com/Azure-Samples/compute-automation-configurations/master/automate-iis.ps1");"commandToExecute" = "powershell -ExecutionPolicy Unrestricted -File automate-iis.ps1"}$vmss = Get-AzVmss `-ResourceGroupName "myResourceGroup" `-VMScaleSetName "myScaleSet"Add-AzVmssExtension -VirtualMachineScaleSet $vmss `-Name "customScript" `-Publisher "Microsoft.Compute" `-Type "CustomScriptExtension" `-TypeHandlerVersion 1.8 `-Setting $publicSettingsUpdate-AzVmss `-ResourceGroupName "myResourceGroup" `-Name "myScaleSet" `-VirtualMachineScaleSet $vmssGet-AzPublicIpAddress -ResourceGroupName "myResourceGroup" | Select IpAddress