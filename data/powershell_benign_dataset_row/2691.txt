function Get-SystemInfo {$Mod = New-InMemoryModule -ModuleName SysInfo$ProcessorType = psenum $Mod SYSINFO.PROCESSOR_ARCH UInt16 @{PROCESSOR_ARCHITECTURE_INTEL =   0PROCESSOR_ARCHITECTURE_MIPS =    1PROCESSOR_ARCHITECTURE_ALPHA =   2PROCESSOR_ARCHITECTURE_PPC =     3PROCESSOR_ARCHITECTURE_SHX =     4PROCESSOR_ARCHITECTURE_ARM =     5PROCESSOR_ARCHITECTURE_IA64 =    6PROCESSOR_ARCHITECTURE_ALPHA64 = 7PROCESSOR_ARCHITECTURE_AMD64 =   9PROCESSOR_ARCHITECTURE_UNKNOWN = 0xFFFF}$SYSTEM_INFO = struct $Mod SYSINFO.SYSTEM_INFO @{ProcessorArchitecture = field 0 $ProcessorTypeReserved = field 1 Int16PageSize = field 2 Int32MinimumApplicationAddress = field 3 IntPtrMaximumApplicationAddress = field 4 IntPtrActiveProcessorMask = field 5 IntPtrNumberOfProcessors = field 6 Int32ProcessorType = field 7 Int32AllocationGranularity = field 8 Int32ProcessorLevel = field 9 Int16ProcessorRevision = field 10 Int16}$FunctionDefinitions = @((func kernel32 GetSystemInfo ([Void]) @($SYSTEM_INFO.MakeByRefType())))$Types = $FunctionDefinitions | Add-Win32Type -Module $Mod -Namespace 'Win32SysInfo'$Kernel32 = $Types['kernel32']$SysInfo = [Activator]::CreateInstance($SYSTEM_INFO)$Kernel32::GetSystemInfo([Ref] $SysInfo)$SysInfo}