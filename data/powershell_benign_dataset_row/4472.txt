$configFile = [System.IO.Path]::ChangeExtension($MyInvocation.MyCommand.Path, 'json')if (Test-Path -Path $configFile){$ConfigurationData = Get-Content -Path $configFile | ConvertFrom-Json}else{$ConfigurationData = @{AllNodes = @(@{NodeName                  = 'localhost'CertificateFile           = $env:DscPublicCertificatePathName                      = 'PSTestGallery'TestSourceLocation        = 'https://www.poshtestgallery.com/api/v2/'TestPublishLocation       = 'https://www.poshtestgallery.com/api/v2/package/'TestScriptSourceLocation  = 'https://www.poshtestgallery.com/api/v2/items/psscript/'TestScriptPublishLocation = 'https://www.poshtestgallery.com/api/v2/package/'SourceLocation            = 'https://www.nuget.org/api/v2'PublishLocation           = 'https://www.nuget.org/api/v2/package'ScriptSourceLocation      = 'https://www.nuget.org/api/v2/items/psscript/'ScriptPublishLocation     = 'https://www.nuget.org/api/v2/package'PackageManagementProvider = 'NuGet'TestModuleName            = 'ContosoServer'})}}Configuration MSFT_PSRepository_AddRepository_Config{Import-DscResource -ModuleName 'PowerShellGet'node $AllNodes.NodeName{PSRepository 'Integration_Test'{Name                  = $Node.NameSourceLocation        = $Node.TestSourceLocationPublishLocation       = $Node.TestPublishLocationScriptSourceLocation  = $Node.TestScriptSourceLocationScriptPublishLocation = $Node.TestScriptPublishLocationInstallationPolicy    = 'Trusted'}}}Configuration MSFT_PSRepository_InstallTestModule_Config{Import-DscResource -ModuleName 'PowerShellGet'node $AllNodes.NodeName{PSModule 'Integration_Test'{Name       = $Node.TestModuleNameRepository = $Node.Name}}}Configuration MSFT_PSRepository_ChangeRepository_Config{Import-DscResource -ModuleName 'PowerShellGet'node $AllNodes.NodeName{PSRepository 'Integration_Test'{Name                      = $Node.NameSourceLocation            = $Node.SourceLocationPublishLocation           = $Node.PublishLocationScriptSourceLocation      = $Node.ScriptSourceLocationScriptPublishLocation     = $Node.ScriptPublishLocationPackageManagementProvider = $Node.PackageManagementProviderInstallationPolicy        = 'Untrusted'}}}Configuration MSFT_PSRepository_RemoveRepository_Config{Import-DscResource -ModuleName 'PowerShellGet'node $AllNodes.NodeName{PSRepository 'Integration_Test'{Ensure = 'Absent'Name   = $Node.Name}}}