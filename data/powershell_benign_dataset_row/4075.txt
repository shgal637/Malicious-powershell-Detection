Function Get-ComputerName {Set-Variable -Name ComputerName -Scope Local -Force$ComputerName = Read-Host "Enter the computer name"Return $ComputerNameRemove-Variable -Name ComputerName -Scope Local -Force}Function Get-BitlockeredRecoveryKey {param ([String]$ComputerName)Set-Variable -Name BitLockerObjects -Scope Local -ForceSet-Variable -Name BitLockerRecoveryKey -Scope Local -ForceSet-Variable -Name Computer -Scope Local -Value $null -ForceSet-Variable -Name System -Scope Local -Force$BitLockerObjects = Get-ADObject -Filter { objectclass -eq 'msFVE-RecoveryInformation' }foreach ($System in $BitLockerObjects) {$System = $System.DistinguishedName$System = $System.Split(',')$System = $System[1]$System = $System.Split('=')$System = $System[1]If ($System -eq $ComputerName) {$Computer = Get-ADComputer -Filter {Name -eq $System}$BitLockerRecoveryKey = Get-ADObject -Filter { objectclass -eq 'msFVE-RecoveryInformation' } -SearchBase $Computer.DistinguishedName -Properties 'msFVE-RecoveryPassword'Write-Host "Computer Name:"$SystemWrite-Host "Bitlocker Recovery Key:"$BitLockerRecoveryKey.'msFVE-RecoveryPassword'}}If ($Computer -eq $null) {Write-Host "No recovery key exists" -ForegroundColor Red}Remove-Variable -Name BitLockerObjects -Scope Local -ForceRemove-Variable -Name BitLockerRecoveryKey -Scope Local -ForceRemove-Variable -Name Computer -Scope Local -ForceRemove-Variable -Name System -Scope Local -Force}Set-Variable -Name SystemName -Scope Local -ForceclsImport-Module ActiveDirectory -Scope Global -Force$SystemName = Get-ComputerNameGet-BitlockeredRecoveryKey -ComputerName $SystemNameRemove-Variable -Name SystemName -Scope Local -Force