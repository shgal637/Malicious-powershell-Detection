function LoadModules {$currentConfig = $psake.context.peek().configif ($currentConfig.modules) {$scope = $currentConfig.moduleScope$global = [string]::Equals($scope, "global", [StringComparison]::CurrentCultureIgnoreCase)$currentConfig.modules | ForEach-Object {resolve-path $_ | ForEach-Object {"Loading module: $_"$module = Import-Module $_ -passthru -DisableNameChecking -global:$globalif (!$module) {throw ($msgs.error_loading_module -f $_.Name)}}}""}}