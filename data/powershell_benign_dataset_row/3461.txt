function Test-DataFlowDebugScenario{$dfname = Get-DataFactoryName$rgname = Get-ResourceGroupName$rglocation = Get-ProviderLocation ResourceManagement$dflocation = Get-ProviderLocation DataFactoryManagementNew-AzResourceGroup -Name $rgname -Location $rglocation -Forcetry{$df = Set-AzDataFactoryV2 -ResourceGroupName $rgname -Name $dfname -Location $dflocation -Force$session = Start-AzDataFactoryV2DataFlowDebugSession -DataFactory $df$list = Get-AzDataFactoryV2DataFlowDebugSession -DataFactory $dfAssert-AreEqual 1 $list.CountAdd-AzDataFactoryV2DataFlowDebugSessionPackage -DataFactory $df -PackageFile .\Resources\dataFlowDebugPackage.json -SessionId $session.SessionId$result = Invoke-AzDataFactoryV2DataFlowDebugSessionCommand -DataFactory $df -Command executePreviewQuery -SessionId $session.SessionId -StreamName source1 -RowLimit 100Assert-AreEqual 'Succeeded' $result.StatusAssert-NotNull $result.DataStop-AzDataFactoryV2DataFlowDebugSession -DataFactory $df -SessionId $session.SessionId -Force$newList = Get-AzDataFactoryV2DataFlowDebugSession -DataFactory $dfAssert-AreEqual 0 $newList.Count}finally{CleanUp $rgname $dfname}}