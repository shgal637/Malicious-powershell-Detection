class ExceptionFormatter {static [pscustomobject]Summarize([System.Management.Automation.ErrorRecord]$Exception) {return [pscustomobject]@{CommandName = $Exception.InvocationInfo.MyCommand.NameMessage = $Exception.Exception.MessageTargetObject = $Exception.TargetObjectPosition = $Exception.InvocationInfo.PositionMessageCategoryInfo = $Exception.CategoryInfo.ToString()FullyQualifiedErrorId = $Exception.FullyQualifiedErrorId}}static [string]ToJson([System.Management.Automation.ErrorRecord]$Exception) {return ([ExceptionFormatter]::Summarize($Exception) | ConvertTo-Json)}}