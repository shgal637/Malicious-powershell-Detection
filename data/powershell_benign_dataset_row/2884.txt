Task default -depends TestTask Test {[string]$currentPath = Get-Location[string]$parentPath = Split-Path $currentPath -Parent[string[]]$global:locations = @()[string[]]$expected = "$currentPath,$parentPath,$parentPath,$parentPath,$currentPath"[scriptblock]$cmd = {$global:locations += Get-Locationthrow "forced error"}$global:locations += Get-Locationtry {Exec -cmd $cmd -maxRetries 2 -workingDirectory $parentPath}catch {}$global:locations += Get-Location[string]$actual = $global:locations -join ","$actual = $actual.ToLower()Assert ($actual -eq $expected) "Expected: '$expected' Actual: '$actual'"}