Set-Variable -Name Errors -Value $null -Scope Global -ForceSet-Variable -Name LogFile -Value "c:\windows\waller\Logs\BuildLogs\AdobeFlashPlayer.log" -Scope Global -ForceSet-Variable -Name RelativePath -Scope Global -ForceFunction ConsoleTitle ($Title){$host.ui.RawUI.WindowTitle = $Title}Function GetRelativePath { $Global:RelativePath = (split-path $SCRIPT:MyInvocation.MyCommand.Path -parent)+"\" }Function DisableIEActiveXControl ($AppName,$GUID,$Flag) {$Key = "HKLM:\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\"+$GUIDIf ((Test-Path $Key) -eq $true) {Write-Host $AppName"....." -NoNewlineSet-ItemProperty -Path $Key -Name "Compatibility Flags" -Value $Flag -Force$Var = Get-ItemProperty -Path $Key -Name "Compatibility Flags"If ($Var."Compatibility Flags" -eq 1024) {Write-Host "Disabled" -ForegroundColor Yellow} else {Write-Host "Enabled" -ForegroundColor Red}}}Function EnableIEActiveXControl ($AppName,$GUID,$Flag) {$Key = "HKLM:\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\"+$GUIDIf ((Test-Path $Key) -eq $true) {Write-Host $AppName"....." -NoNewlineSet-ItemProperty -Path $Key -Name "Compatibility Flags" -Value $Flag -Force$Var = Get-ItemProperty -Path $Key -Name "Compatibility Flags"If ($Var."Compatibility Flags" -eq 0) {Write-Host "Enabled" -ForegroundColor Yellow} else {Write-Host "Disabled" -ForegroundColor Red}}}clsEnableIEActiveXControl "Flash for IE" "{D27CDB6E-AE6D-11CF-96B8-444553540000}" "0x00000000"Start-Sleep -Seconds 5